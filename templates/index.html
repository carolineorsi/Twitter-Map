<html>
    <head>
        <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js'></script>
        <script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="/static/js/underscore.js"></script>
        <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css' rel='stylesheet' />
        <style>
            body {
                margin: 0;
                padding: 0;
            }

            #map {
                height: 90%;
                width: 100%;
            }

            #get-tweet {
                font-size: 20;
                margin-top: 5px;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <div>
            <button id="get-tweet">Get Tweets</button>
        </div>
        <div id="temp-input">
        </div>

        <script>
            // function initialize() {
            //     var mapOptions = {
            //         center: { lat: 39.0997, lng: -94.5783},
            //         zoom: 4
            //     };

            //     map = new google.maps.Map(document.getElementById('map'), mapOptions);

                $("#get-tweet").on('click', getTweet);
            // }

            // google.maps.event.addDomListener(window, 'load', initialize)

            L.mapbox.accessToken = 'pk.eyJ1IjoiY2Fyb2xpbmVvcnNpIiwiYSI6ImJYQW4tLUkifQ.-h-le0HORavJ6JSMiafpQQ';
            map = L.mapbox.map('map', 'examples.map-i86nkdio')
                .setView([39.0997, -94.5783], 4);


            function addMarker(lat, lng, color) {

                L.marker([lat, lng], {
                    icon: L.mapbox.marker.icon({
                        'marker-size': 'small',
                        'marker-color': color
                    })
                }).addTo(map);

            };

            function getTweet() {
                $.get(
                    '/get-tweet',
                    function(response) {
                        // console.log(response);

                        _.each(response.data, function(tweet) {
                            // console.log(tweet.time)
                            setTimeout(function() {
                                addMarker(tweet.latitude, tweet.longitude, tweet.color);
                            }, tweet.time);
                        }
                        );
                    }
                );
            }

            // function addMarker(lat, lng, text, tag) {
            //     var latlng = new google.maps.LatLng(lat, lng);

            //     var marker = new google.maps.Marker({
            //         position: latlng,
            //         map: map
            //     });

            //     if (tag === "packers") {
            //         marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/grn-circle-lv.png')
            //     }
            //     else if (tag === "seahawks") {
            //         marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/blu-circle-lv.png')
            //     }
            //     else if (tag === "colts") {
            //         marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/wht-circle-lv.png')
            //     }
            //     // else if (tag === "patriots") {
            //     //     marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/red-circle-lv.png')
            //     // }
            //     else {
            //         marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/red-circle-lv.png')
            //     }


            //     // map.setCenter(latlng);

            //     var contentString = text;

            //     var infowindow = new google.maps.InfoWindow({
            //         content: contentString
            //     })

            //     // infowindow.open(map, marker);
            //     // setTimeout(function() {
            //     //     infowindow.close();
            //     // }, 5000);
            // }

        </script>

    </body>
</html>