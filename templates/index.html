<html>
    <head>
        <style>
            #map {
                height: 90%;
                width: 100%;
            }

            #get-tweet {
                font-size: 20;
                margin-top: 5px;
            }
        </style>
    </head>
    <body>

        <script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="/static/js/underscore.js"></script>
        <script>
            function initialize() {
                var mapOptions = {
                    center: { lat: 37.7833, lng: -122.4167},
                    zoom: 4
                };

                map = new google.maps.Map(document.getElementById('map'), mapOptions);

                $("#get-tweet").on('click', getTweet);
            }

            google.maps.event.addDomListener(window, 'load', initialize)

            function getTweet() {
                $.get(
                    '/get-tweet',
                    function(response) {
                        // console.log(response);

                        _.each(response.data, function(tweet) {
                            console.log(tweet.text)
                            addMarker(tweet.latitude, tweet.longitude, tweet.text, tweet.tag);
                        }
                        );
                    }
                );
            }

            function addMarker(lat, lng, text, tag) {
                var latlng = new google.maps.LatLng(lat, lng);

                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map
                });

                if (tag === "packers") {
                    marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/grn-circle-lv.png')
                }
                else if (tag === "seahawks") {
                    marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/blu-circle-lv.png')
                }
                else if (tag === "colts") {
                    marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/wht-circle-lv.png')
                }
                // else if (tag === "patriots") {
                //     marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/red-circle-lv.png')
                // }
                else {
                    marker.setIcon('http://maps.google.com/mapfiles/kml/paddle/red-circle-lv.png')
                }


                map.setCenter(latlng);

                var contentString = text;

                var infowindow = new google.maps.InfoWindow({
                    content: contentString
                })

                // infowindow.open(map, marker);
                // setTimeout(function() {
                //     infowindow.close();
                // }, 5000);
            }

        </script>

        <div id="map"></div>
        <div>
            <button id="get-tweet">Get Tweet</button>
        </div>
        <div id="temp-input">
        </div>

    </body>
</html>